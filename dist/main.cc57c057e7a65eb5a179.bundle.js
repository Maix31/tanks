(()=>{"use strict";var t,e={930:(t,e,i)=>{i(260);class s extends Phaser.GameObjects.Text{constructor(t){super(t,10,40,"",{color:"black",fontSize:"28px"}),t.add.existing(this),this.setOrigin(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}class a{constructor(t,e,i,s,a,r,n){if(s<=0)throw new Error("Please don't use 0 health HealthBars!");this.maxHealth=s,this.health=s,this.barBackground=t.add.image(e,i,a),this.barColor=t.add.image(e,i,r),this.barGlass=t.add.image(e,i,n),this.barBackground.setOrigin(0,.5),this.barColor.setOrigin(0,.5),this.barGlass.setOrigin(0,.5);let h=1/4,o=1/6;this.barBackground.setScale(h,o),this.barColor.setScale(h,o),this.barGlass.setScale(h,o)}update(t){this.health=t;let e=this.health/this.maxHealth;this.barColor.setCrop(0,0,this.barColor.width*e,this.barColor.height)}setMaxHealth(t){this.maxHealth=t}}class r extends Phaser.GameObjects.Text{constructor(t){super(t,10,70,"",{color:"black",fontSize:"28px"}),t.add.existing(this),this.setOrigin(0)}update(){this.setText(`${Math.floor(this.scene.input.mousePointer.x)} ${Math.floor(this.scene.input.mousePointer.y)}`)}}function n(t,e){return Math.random()*(e-t)+t}function h(t,e,i){return t*t+e*e<=i*i}class o extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i,s,a,r,n,h,o,u){super(t,e,i,r,u),this.damage=n,this.blastRadius=h,t.add.existing(this),t.physics.add.existing(this,!1),this.setVelocity(s*o,a*o)}collideTerrain(t){return t.checkCollision(this.x,this.y)}collideTank(t){return t.body.hitTest(this.x,this.y)}getBlastRadius(){return this.blastRadius}getDamage(){return this.damage}}class u extends o{constructor(t,e,i,s,a,r,n){super(t,e,i,s,a,r,u.defaultDamage,u.defaultBlastRadius,u.defaultSpeed,n),this.sound=t.sound.add(u.defaultSound)}playSound(){this.sound.play()}}u.defaultDamage=10,u.defaultBlastRadius=10,u.defaultSpeed=10,u.defaultSound="basicProjectileSound";class l extends o{constructor(t,e,i,s,a,r,n){super(t,e,i,s,a,r,l.defaultDamage,l.defaultBlastRadius,l.defaultSpeed,n),this.sound=t.sound.add(l.defaultSound)}playSound(){this.sound.play()}}var d,c,g,p;l.defaultDamage=20,l.defaultBlastRadius=20,l.defaultSpeed=15,l.defaultSound="superiorProjectileSound",function(t){t[t.BasicProjectile=0]="BasicProjectile",t[t.SuperiorProjectile=1]="SuperiorProjectile"}(d||(d={}));class f extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i,s,a,r,n,h=f.deafaultHealth){super(t,e,i,a),this.firePower=f.deafaultFirePower,this.scene=t,this.scale=.5,this.setScale(this.scale),this.flipX=n,this.initialHealth=h,this.health=h,this.healthBar=s,this.healthBar.setMaxHealth(this.health),this.gun=t.add.image(e,i,r),this.gun.flipX=n,this.gun.setScale(this.scale),this.gun.setOrigin(0,0),this.currentProjectile=d.BasicProjectile,this.engineSound=t.sound.add("engineSound"+Math.round(Math.random())),t.add.existing(this),t.physics.add.existing(this,!1),this.turnGravityOff(),this.setCollideWorldBounds(),this.body.velocity.x=.02,this.body.velocity.y=.02,this.setAcceleration(0,100)}update(t,e,i){this.collideWithTerrain(t),this.gunFollow()}moveLeft(t){this.playEngineSound(),this.x-=f.movementSpeed*t}moveRight(t){this.playEngineSound(),this.x+=f.movementSpeed*t}setGrounded(t){this.isOnGround=t,this.turnGravityOff()}turnGravityOff(){this.setGravity(0,-400)}turnGravityOn(){this.setGravity(0,0)}collideWithTerrain(t){let e=Math.floor(this.x),i=Math.floor(this.y),s=this.height/2;for(let a=i-s;a<i+s;a++)for(let i=e-s;i<e+s;i++)t.getPixel(i,a);t.checkCollision(this.x,this.y+this.height/3)?(this.setAcceleration(0,0),this.setVelocity(0,0)):this.setAcceleration(0,100)}gunFollow(){let t;t=this.flipX?.1*this.width*this.scale:-1*this.width*.8*this.scale;let e=.38*this.height*this.scale;this.gun.setPosition(this.x+t,this.y-e)}fire(t){let e=this.flipX?1:-1,i=new Phaser.Math.Vector2(this.getFirePower(),0);i.rotate(Phaser.Math.DegToRad(this.gun.angle));let s=function(t,e,i,s,a,r){switch(e){case d.BasicProjectile:return new u(t,i,s,a,r,"cannonball");case d.SuperiorProjectile:return new l(t,i,s,a,r,"cannonball");default:throw new Error("Unimplemented! Most likely you created a new Projectile and didn't register it in the ProjectileType.")}}(t,this.currentProjectile,this.gun.x,this.gun.y,e*i.x,i.y);return s.playSound(),s}setFirePower(t){Number.isNaN(t)&&(t=0),this.firePower=Phaser.Math.Clamp(t,f.minFirePower,f.maxFirePower)}getFirePower(){return this.firePower}setGunAngle(t){Number.isNaN(t)&&(t=0),this.gun.angle=Phaser.Math.Clamp(t,-f.maxGunAngle,-f.minGunAngle)}getGunAngle(){return this.gun.angle}incrementFirePower(){this.setFirePower(this.firePower+1)}decrementFirePower(){this.setFirePower(this.firePower-1)}incrementGunAngle(){this.setGunAngle(this.gun.angle-1)}decrementGunAngle(){this.setGunAngle(this.gun.angle+1)}setProjectile(t){this.currentProjectile=t}takeDamage(t){this.health-=t,this.health<0&&(this.health=0),this.healthBar.update(this.health)}playEngineSound(){this.engineSound.isPlaying||this.engineSound.play()}getHealth(){return this.health}reset(t,e,i){this.setPosition(t*(n(e,i)/100),0),this.health=this.initialHealth,this.healthBar.update(this.health)}}f.movementSpeed=.02,f.deafaultFirePower=50,f.deafaultHealth=70,f.minGunAngle=0,f.maxGunAngle=66,f.minFirePower=10,f.maxFirePower=100,function(t){t[t.Air=0]="Air",t[t.Ground=1]="Ground"}(c||(c={}));class m{constructor(t,e,i){this.width=e,this.height=i,this.data=this.generateTerrain(),this.canvas=this.initCanvas(t),this.terrainImage=t.add.image(e/2,i/2,this.canvas)}generateTerrain(){let t=Array(this.width*this.height),e=[...Array(this.width)].map(Math.random);e[0]=.7;let i=function(t,e,i){let s=[];const a=t.length;for(let e=0;e<a;e++){let i=0,r=0,n=1;for(let s=0;s<8;s++){let h=t.length>>s,o=Math.floor(e/h)*h,u=(o+h)%a,l=(e-o)/h,d=(1-l)*t[o]+l*t[u];r+=n,i+=d*n,n/=2}s.push(i/r)}return s}(e);for(let e=0;e<this.height;e++)for(let s=0;s<this.width;s++)e>=i[s]*this.height?t[s+e*this.width]=c.Ground:t[s+e*this.width]=c.Air;return t}initCanvas(t){return this.canvas=t.textures.createCanvas("terrain",this.width,this.height),this.updateCanvas(),this.canvas}updateCanvas(){let t=new Uint8ClampedArray(this.width*this.height*4);for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)t[4*(i+e*this.width)+0]=0,t[4*(i+e*this.width)+1]=150,t[4*(i+e*this.width)+2]=0,t[4*(i+e*this.width)+3]=255*this.data[i+e*this.width];let e=new ImageData(t,this.width);this.canvas.putData(e,0,0),this.canvas.update()}damageTerrain(t,e,i){for(let s=e-i;s<e+i;s++)for(let a=t-i;a<t+i;a++)h(a-t,s-e,i)&&this.setPixel(a,s,0);this.updateCanvas()}isOutsideBoundry(t,e){return t<0||t>this.width||e<0||e>this.height}setPixel(t,e,i){this.isOutsideBoundry(t,e)||(this.data[Math.floor(t)+Math.floor(e)*this.width]=i)}getPixel(t,e){return this.data[t+e*this.width]}checkCollision(t,e){return!this.isOutsideBoundry(t,e)&&(t=Math.floor(t),e=Math.floor(e),this.data[t+e*this.width]!=c.Air)}getData(){return this.data}getWidth(){return this.width}getHeight(){return this.height}reset(){this.data=this.generateTerrain(),this.updateCanvas()}}class w extends Phaser.Scene{constructor(){super({key:"MainScene"}),this.currentProjectile=void 0,this.timeSinceStartOfAITurn=0,this.durationOfAITurn=1e3*n(2,3),this.shouldMoveLeft=!1,this.shouldMoveRigth=!1,this.shouldFire=!1,this.isItLeftPlayersTurn=Math.random()<.5}preload(){this.load.image("background","assets/background.png"),this.load.image("zeppelin","assets/zeppelin.png"),this.load.image("cloud_0","assets/cloud/cloud_0.png"),this.load.image("cloud_1","assets/cloud/cloud_1.png"),this.load.image("cloud_2","assets/cloud/cloud_2.png"),this.load.image("cloud_3","assets/cloud/cloud_3.png"),this.load.spritesheet("cannonball","assets/tank/cannonball.png",{frameWidth:16,frameHeight:19}),this.load.image("tankBodyBlue","assets/tank/tank_body_blue_scaled.png"),this.load.image("tankBodyRed","assets/tank/tank_body_red_scaled.png"),this.load.image("tankGunBlue","assets/tank/tank_gun_blue_scaled.png"),this.load.image("tankGunRed","assets/tank/tank_gun_red_scaled.png"),this.load.image("barBackground","assets/hud/bar_background.png"),this.load.image("barRed","assets/hud/bar_red.png"),this.load.image("barBlue","assets/hud/bar_blue.png"),this.load.image("barGlass","assets/hud/bar_glass.png"),this.load.image("fireButton","assets/gui/fire_button.png"),this.load.image("textPower","assets/gui/power_input_text.png"),this.load.image("textAngle","assets/gui/angle_input_text.png"),this.load.image("minus","assets/gui/minus.png"),this.load.image("plus","assets/gui/plus.png"),this.load.image("arrowRigth","assets/gui/arrow_rigth.png"),this.load.spritesheet("currentProjectileButton","assets/gui/current_projectile_button.png",{frameWidth:94,frameHeight:45}),this.load.audio("basicProjectileSound","assets/sounds/basic_projectile.wav"),this.load.audio("superiorProjectileSound","assets/sounds/superior_projectile.wav"),this.load.audio("ambientMusic","assets/sounds/ambient_sound.wav"),this.load.audio("uiClickSound","assets/sounds/ui_click.wav"),this.load.audio("engineSound0","assets/sounds/engine_sound_0.wav"),this.load.audio("engineSound1","assets/sounds/engine_sound_1.wav")}create(){let{width:t,height:e}=this.cameras.main;this.background=this.add.image(0,0,"background");let i=t/this.background.width,h=e/this.background.height;this.background.setPosition(this.background.width/2*i,this.background.height/2*h),this.background.setScale(t/this.background.width,e/this.background.height);let o=(i,s,a,r)=>{let h=this.add.image(0,0,i),o=n(1*-t,1*t),u=n(0,.3*e);return h.setPosition(h.width/2*r+o,h.height/2*r+u),h.setScale(r),h.setAlpha(a),h.setFlipX(s),this.tweens.add({targets:h,x:2*t,duration:1e3*n(200,400),repeat:-1,yoyo:!0}),h};this.cloud=[...Array(4)].map(((t,e)=>o("cloud_"+e,Math.random()<.5,.6,1/8))),this.zeppelin=o("zeppelin",!0,1,.5),this.terrain=new m(this,t,e);let u=new a(this,0*t,.1*e,100,"barBackground","barBlue","barGlass"),l=new a(this,.68*t,.1*e,100,"barBackground","barRed","barGlass");this.tankLeft=new f(this,0,0,u,"tankBodyBlue","tankGunBlue",!0),this.tankRigth=new f(this,t,0,l,"tankBodyRed","tankGunRed",!1),this.cursors=this.input.keyboard.createCursorKeys();let d=.05*t,c=.05*e;this.fireButton=this.add.sprite(0,0,"fireButton"),this.fireButton.setPosition(t-this.fireButton.width/2-d,e-this.fireButton.height/2-c),this.fireButton.setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.isItLeftPlayersTurn&&(this.shouldFire=!0)})),this.powerButtonIncrement=this.add.image(.6*t,.88*e,"plus").setScale(.4).setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.tankLeft.incrementFirePower()})),this.powerButtonDecrement=this.add.image(.4*t,.88*e,"minus").setScale(.4).setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.tankLeft.decrementFirePower()})),this.angleButtonIncrement=this.add.image(.6*t,.95*e,"plus").setScale(.4).setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.tankLeft.incrementGunAngle()})),this.angleButtonDecrement=this.add.image(.4*t,.95*e,"minus").setScale(.4).setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.tankLeft.decrementGunAngle()})),this.currentsTurnText=this.add.text(.5*t,0,""),this.textPower=this.add.image(.5*t,.88*e,"textPower"),this.textAngle=this.add.image(.5*t,.95*e,"textAngle"),this.textPower.scale=1.2,this.textAngle.scale=1.2,this.textPowerNumber=this.add.text(t*(43.2/100),.865*e,`${this.tankLeft.getFirePower()}`,{align:"center"}),this.textAngleNumber=this.add.text(t*(43.2/100),.94*e,`${this.tankLeft.getGunAngle()}`,{align:"center"}),this.arrowButtonLeft=this.add.image(.1*t,.9*e,"arrowRigth"),this.arrowButtonRigth=this.add.image(.23*t,.9*e,"arrowRigth"),this.arrowButtonLeft.setInteractive().on("pointerdown",(t=>{this.uiClickSound.play(),this.shouldMoveLeft=!0})),this.arrowButtonLeft.setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.shouldMoveLeft=!1})),this.arrowButtonRigth.setInteractive().on("pointerdown",(t=>{this.uiClickSound.play(),this.shouldMoveRigth=!0})),this.arrowButtonRigth.setInteractive().on("pointerup",(t=>{this.uiClickSound.play(),this.shouldMoveRigth=!1})),this.arrowButtonLeft.flipX=!0,this.currentProjectileButton={currentIndex:0,sprite:this.add.sprite(.7*t,.9*e,"currentProjectileButton",0).setInteractive().on("pointerup",(t=>{console.log(this.currentProjectileButton.currentIndex),this.currentProjectileButton.currentIndex+=1,this.currentProjectileButton.currentIndex%=2,this.currentProjectileButton.sprite.setFrame(this.currentProjectileButton.currentIndex),this.tankLeft.setProjectile(this.currentProjectileButton.currentIndex)}))},this.ambientMusic=this.sound.add("ambientMusic"),this.ambientMusic.play({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!0,delay:0}),this.uiClickSound=this.sound.add("uiClickSound"),this.input.on("pointerup",(t=>{})),this.fpsText=new s(this),this.mousePossitionText=new r(this),P(this)}update(t,e){let{width:i,height:s}=this.cameras.main;!function(t,e,i){if(null!=t.currentProjectile){let s=function(t,e,i,s,a){let r=Math.max(i.width,i.height),{x:n,y:h}=i.getCenter(),o=Phaser.Math.Distance.Between(t.x,t.y,n,h)<r+t.getBlastRadius();return t.x<0||t.x>s||t.y>a?{hit:g.OutOfBounds,object:null,isTankInsideBlasRadius:o}:t.collideTerrain(e)?{hit:g.Terrain,object:e,isTankInsideBlasRadius:o}:t.collideTank(i)?{hit:g.Tank,object:i,isTankInsideBlasRadius:o}:{hit:void 0,object:null,isTankInsideBlasRadius:o}}(t.currentProjectile,t.terrain,t.tankRigth,e,i);if(null!=s.hit){switch(s.hit){case g.OutOfBounds:break;case g.Tank:s.object.takeDamage(t.currentProjectile.getDamage());break;case g.Terrain:s.object.damageTerrain(t.currentProjectile.x,t.currentProjectile.y,t.currentProjectile.getBlastRadius());break;default:throw new Error("Unhandled case! Possible someone added a PossibleHitTarget.")}(()=>{if(void 0===t.currentProjectile)throw new Error("Trying to delete undefine Projectile! Logical Error!");t.currentProjectile.destroy(),t.currentProjectile=void 0})()}}}(this,i,s),this.tankLeft.update(this.terrain,t,e),this.tankRigth.update(this.terrain,t,e),null!=function(t,e,i){return 0==t.tankLeft.getHealth()?p.tankLeft:0==t.tankRigth.getHealth()?p.tankRight:void(t.isItLeftPlayersTurn?(void 0===t.currentProjectile&&t.shouldFire&&(t.currentProjectile=t.tankLeft.fire(t),t.shouldFire=!1,t.isItLeftPlayersTurn=!t.isItLeftPlayersTurn,t.timeSinceStartOfAITurn=e,t.durationOfAITurn=1e3*n(2,3)),(t.cursors.left.isDown||t.shouldMoveLeft)&&t.tankLeft.moveLeft(i),(t.cursors.right.isDown||t.shouldMoveRigth)&&t.tankLeft.moveRight(i)):Math.abs(e-t.timeSinceStartOfAITurn)>t.durationOfAITurn&&(t.currentProjectile=t.tankRigth.fire(t),t.isItLeftPlayersTurn=!t.isItLeftPlayersTurn))}(this,t,e)&&P(this),this.currentsTurnText.setText("Current turn "+(this.isItLeftPlayersTurn?"Player":"AI")),this.textPowerNumber.setText(`${Math.round(this.tankLeft.getFirePower())}`),this.textAngleNumber.setText(`${Math.round(-this.tankLeft.getGunAngle())}`),this.fpsText.update(),this.mousePossitionText.update()}}function P(t){let{width:e,height:i}=t.cameras.main;void 0!==t.currentProjectile&&t.currentProjectile.destroy(),t.shouldMoveLeft=!1,t.shouldMoveRigth=!1,t.shouldFire=!1,t.tankLeft.reset(e,1,30),t.tankRigth.reset(e,70,99),t.terrain.reset(),t.isItLeftPlayersTurn=Math.random()<.5}!function(t){t[t.OutOfBounds=0]="OutOfBounds",t[t.Terrain=1]="Terrain",t[t.Tank=2]="Tank"}(g||(g={})),function(t){t[t.tankLeft=0]="tankLeft",t[t.tankRight=1]="tankRight"}(p||(p={}));class k extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.image("phaser-logo","assets/img/phaser-logo.png")}create(){this.scene.start("MainScene")}}const b={type:Phaser.AUTO,backgroundColor:"#ffffff",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:800,height:600},scene:[k,w],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:400}}},dom:{createContainer:!0},audio:{disableWebAudio:!0}};window.addEventListener("load",(()=>{new Phaser.Game(b)}))}},i={};function s(t){var a=i[t];if(void 0!==a)return a.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,s),r.exports}s.m=e,t=[],s.O=(e,i,a,r)=>{if(!i){var n=1/0;for(l=0;l<t.length;l++){for(var[i,a,r]=t[l],h=!0,o=0;o<i.length;o++)(!1&r||n>=r)&&Object.keys(s.O).every((t=>s.O[t](i[o])))?i.splice(o--,1):(h=!1,r<n&&(n=r));if(h){t.splice(l--,1);var u=a();void 0!==u&&(e=u)}}return e}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[i,a,r]},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var a,r,[n,h,o]=i,u=0;if(n.some((e=>0!==t[e]))){for(a in h)s.o(h,a)&&(s.m[a]=h[a]);if(o)var l=o(s)}for(e&&e(i);u<n.length;u++)r=n[u],s.o(t,r)&&t[r]&&t[r][0](),t[n[u]]=0;return s.O(l)},i=self.webpackChunktanks=self.webpackChunktanks||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=s.O(void 0,[216],(()=>s(930)));a=s.O(a)})();